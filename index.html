<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Common Runner (Lamumu Arc.)</title>
  <style>
    body { margin:0; background:#87CEEB; overflow:hidden; font-family:sans-serif; }
    canvas { display:block; width:100vw; height:100vh; background:#87CEEB; }
    .hud { position:fixed; top:10px; left:0; right:0; text-align:center; font-size:24px; color:#fff; text-shadow:0 2px 4px rgba(0,0,0,0.5); }
    .score { position:fixed; top:10px; right:10px; font-size:22px; background:rgba(255,255,255,0.7); padding:6px 10px; border-radius:8px; }
    .hint { position:fixed; bottom:12px; left:50%; transform:translateX(-50%); background:rgba(255,255,255,.8); padding:6px 10px; border-radius:8px; font-size:14px;}
  </style>
</head>
<body>
  <div class="hud">Common Runner <small>(Lamumu Arc.)</small></div>
  <div class="score" id="score">Score: 0</div>
  <div class="hint" id="hint">↑ Jump • ↓ Duck • R Restart</div>
  <canvas id="game"></canvas>

<script>
(() => {
  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const scoreEl = document.getElementById('score');
  const hintEl  = document.getElementById('hint');
  let W, H, groundY;
  function resize(){
    W = canvas.width = window.innerWidth;
    H = canvas.height = window.innerHeight;
    groundY = H - 100;
  }
  window.addEventListener('resize', resize);
  resize();

  // Player
  const player = { 
    x:90, y:0, vy:0, width:60, height:60, frame:0, frameTick:0, ducking:false,
    jump(){ if(this.y<=0){ this.vy=16; this.y=1; } },
    update(dt){
      if(this.y>0 || this.vy>0){ this.vy -= 0.8; this.y += this.vy; if(this.y<0){ this.y=0; this.vy=0; } }
    },
    draw(ctx){
      const h = this.height, w = this.width;
      const x = this.x, y = groundY-h-this.y;
      ctx.fillStyle = "#fff";
      ctx.fillRect(x, y, w, h);
    },
    hitbox(){
      return {x:this.x, y:groundY-this.height-this.y, w:this.width, h:this.height};
    }
  };

  // Obstacles
  let obstacles=[], obstacleTimer=0;
  function spawnObstacle(){
    const h = 40+Math.random()*40;
    const w = 20+Math.random()*20;
    obstacles.push({x:W, y:groundY-h, w, h});
  }

  // Game state
  let last=0, score=0, gameOver=false;
  let speed = 6.5;
  const maxSpeed = 14;
  let animFrame;

  // Restart
  function restart(){
    cancelAnimationFrame(animFrame);
    ctx.clearRect(0,0,W,H);
    obstacles.length=0;
    obstacleTimer = 0; score=0; speed=6.5; last=0; gameOver=false;
    player.y=0; player.vy=0; player.ducking=false;
    hintEl.textContent = "↑ Jump • ↓ Duck • R Restart";
    animFrame = requestAnimationFrame(loop);
  }

  window.addEventListener('keydown',e=>{
    if(e.code==="ArrowUp" && !gameOver){ player.jump(); }
    if(e.code==="KeyR"){ restart(); }
  });

  function overlap(a,b){
    return !(a.x+a.w<b.x || a.x>b.x+b.w || a.y+a.h<b.y || a.y>b.y+b.h);
  }

  function loop(ts){
    const dt = Math.min(34, ts - last || 16); last = ts;
    ctx.clearRect(0,0,W,H);

    // Background
    ctx.fillStyle="#87CEEB"; ctx.fillRect(0,0,W,H);
    ctx.fillStyle="#228B22"; ctx.fillRect(0,groundY,W,H-groundY);

    // Obstacles
    obstacleTimer -= dt;
    if(obstacleTimer<=0){
      spawnObstacle();
      const ms = 1000 + Math.random()*1000;
      obstacleTimer = ms;
    }
    for(let i=obstacles.length-1;i>=0;i--){
      let o=obstacles[i];
      o.x -= speed;
      ctx.fillStyle="#8B0000";
      ctx.fillRect(o.x, o.y, o.w, o.h);
      if(o.x+o.w<0) obstacles.splice(i,1);
    }

    // Player
    player.update(dt);
    player.draw(ctx);

    // Collisions
    const hb = player.hitbox();
    for(const o of obstacles){
      if(overlap(hb, o)){ gameOver=true; break; }
    }

    // Score
    if(!gameOver){
      score += dt * 0.06;
      speed = Math.min(maxSpeed, speed+0.002);
      scoreEl.textContent = "Score: " + Math.floor(score);
      animFrame = requestAnimationFrame(loop);
    } else {
      ctx.fillStyle="rgba(0,0,0,0.55)"; ctx.fillRect(0,0,W,H);
      ctx.fillStyle="#fff"; ctx.textAlign="center";
      ctx.font="bold 32px Arial"; ctx.fillText("Game Over", W/2, H/2 - 10);
      ctx.font="18px Arial"; ctx.fillText("Press R to Restart", W/2, H/2 + 26);
    }
  }

  animFrame = requestAnimationFrame(loop);
})();
</script>
</body>
</html>
